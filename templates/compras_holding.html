<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Compras Holding</title>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css'>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css'>
    <style>
        body {
            background-image: url('/static/images/fundo.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin: 0;
            padding: 20px;
            overflow-y: auto;
        }

        .container {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 0 10px;
        }

        .box {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .input, .textarea, .select select {
            font-size: 16px !important;
            height: 2.75em !important;
        }

        .file-cta {
            background-color: #f5f5f5;
            border-color: #dbdbdb;
        }

        .button {
            background-color: #36a7e3;
            color: white;
            border: none;
        }

        .button:hover {
            background-color: #2f85c7;
        }

        .button:active {
            background-color: #1e6099;
        }

        /* Adicionando espaço entre o ícone e o texto no botão */
        .button .file-icon, .button .fas {
            margin-right: 10px; /* Espaço de 10px à direita do ícone */
        }

        @media screen and (max-width: 768px) {
            .box {
                margin: 1rem;
                padding: 1.5rem;
            }
            
            .title.is-4 {
                font-size: 1.5rem !important;
            }
            .button {
                height: 3em;
                font-size: 1rem;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="box">
            <h1 class="title is-4 has-text-centered mb-5">Solicitação de Compra</h1>
            
            <form id="holdingForm" enctype="multipart/form-data">
                <!-- Filial -->
                <div class="field">
                    <label class="label">Filial:</label>
                    <div class="control">
                        <div class="select is-fullwidth">
                            <select name="filial" required>
                                <option value="">Selecione a Filial</option>
                                <option value="042">HOLDING</option>                               
                                <option value="1">GUILHERMINA - 1</option>
                                <option value="4">DIADEMA - 4</option>
                                <option value="5">SHOPPING MAUÁ - 5</option>
                                <option value="6">RIBEIRÃO PIRES - 6</option>
                                <option value="7">HOMERO THON - 7</option>
                                <option value="8">AV. PORTUGAL - 8</option>
                                <option value="9">VALO VELHO - 9</option>
                                <option value="10">ITAMARATI - 10</option>
                                <option value="11">AV. RIO BRANCO - 11</option>
                                <option value="12">PEREIRA BARRETO - 12</option>
                                <option value="13">GIOVANNI BREDA - 13</option>
                                <option value="14">BOQUEIRÃO - 14</option>
                                <option value="15">PARQUE DO CARMO - 15</option>
                                <option value="16">ZAIRA - 16</option>
                                <option value="17">HELIOPOLIS - 17</option>
                                <option value="19">PIMENTAS - 19</option>
                                <option value="20">GUAIANASES - 20</option>
                                <option value="21">AV. GOIÁS - 21</option>
                                <option value="22">BOM CLIMA - 22</option>
                                <option value="23">CAMPO GRANDE - 23</option>
                                <option value="24">JAGUARÉ - 24</option>
                                <option value="25">ITAQUERA - 25</option>
                                <option value="26">EXTREMA - 26</option>
                                <option value="27">MOGI DAS CRUZES - 27</option>
                                <option value="28">ALAMEDA - 28</option>
                                <option value="29">JARDIM GOIAS - 29</option>
                                <option value="30">PASSEIO DAS AGUAS - 30</option>
                                <option value="31">SÃO VICENTE - 31</option>
                                <option value="32">CAMILÓPOLIS - 32</option>
                                <option value="33">INDAIATUBA - 33</option>
                                <option value="34">VILA PRUDENTE - 34</option>
                                <option value="35">LARANJAL PAULISTA - 35</option>
                                <option value="36">SACOMÃ - 36</option>
                                <option value="37">VILA NOVA - 37</option>
                                <option value="38">SAPOPEMBA - 38</option>
                                <option value="39">POÁ - 39</option>
                                <option value="40">CURITIBA - 40</option>
                                <option value="41">FRANCA - 41</option>
                                <option value="130">JARDIM SÃO PAULO - 130</option>
                                <option value="131">CARAPICUIBA - 131</option>
                                <option value="042">ITAQUERA 2 - 042</option>                              											
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Solicitante -->
                <div class="field">
                    <label class="label">Nome do solicitante:</label>
                    <div class="control">
                        <input class="input" type="text" name="nome_solicitante" required>
                    </div>
                </div>
				
                <!-- Descrição do Item -->
                <div class="field">
                    <label class="label">Descrição do Item:</label>
                    <div class="control">
                        <input class="input" type="text" name="descricao_item" required>
                    </div>
                </div>

                <!-- Quantidade -->
                <div class="field">
                    <label class="label">Quantidade:</label>
                    <div class="control">
                        <input class="input" type="number" name="quantidade" min="1" required>
                    </div>
                </div>

                <!-- Motivo -->
                <div class="field">
                    <label class="label">Motivo da Compra:</label>
                    <div class="control">
                        <textarea class="textarea" name="motivo" rows="3" required></textarea>
                    </div>
                </div>
				
                <!-- E-mail do solicitante -->
                <div class="field">
                    <label class="label">E-mail:</label>
                    <div class="control">
                        <input class="input is-fullwidth" type="email" name="email" required>
                    </div>
                </div>			
				
                <!-- Local de Entrega -->
                <div class="field">
                    <label class="label">Local de Entrega:</label>
                    <div class="control">
                        <div class="select is-fullwidth">
                            <select name="local_entrega" required>
                                <option value="">Selecione o Local</option>
                                <option value="042">HOLDING</option>                                  
                                <option value="1">GUILHERMINA - 1</option>
                                <option value="4">DIADEMA - 4</option>
                                <option value="5">SHOPPING MAUÁ - 5</option>
                                <option value="6">RIBEIRÃO PIRES - 6</option>
                                <option value="7">HOMERO THON - 7</option>
                                <option value="8">AV. PORTUGAL - 8</option>
                                <option value="9">VALO VELHO - 9</option>
                                <option value="10">ITAMARATI - 10</option>
                                <option value="11">AV. RIO BRANCO - 11</option>
                                <option value="12">PEREIRA BARRETO - 12</option>
                                <option value="13">GIOVANNI BREDA - 13</option>
                                <option value="14">BOQUEIRÃO - 14</option>
                                <option value="15">PARQUE DO CARMO - 15</option>
                                <option value="16">ZAIRA - 16</option>
                                <option value="17">HELIOPOLIS - 17</option>
                                <option value="19">PIMENTAS - 19</option>
                                <option value="20">GUAIANASES - 20</option>
                                <option value="21">AV. GOIÁS - 21</option>
                                <option value="22">BOM CLIMA - 22</option>
                                <option value="23">CAMPO GRANDE - 23</option>
                                <option value="24">JAGUARÉ - 24</option>
                                <option value="25">ITAQUERA - 25</option>
                                <option value="26">EXTREMA - 26</option>
                                <option value="27">MOGI DAS CRUZES - 27</option>
                                <option value="28">ALAMEDA - 28</option>
                                <option value="29">JARDIM GOIAS - 29</option>
                                <option value="30">PASSEIO DAS AGUAS - 30</option>
                                <option value="31">SÃO VICENTE - 31</option>
                                <option value="32">CAMILÓPOLIS - 32</option>
                                <option value="33">INDAIATUBA - 33</option>
                                <option value="34">VILA PRUDENTE - 34</option>
                                <option value="35">LARANJAL PAULISTA - 35</option>
                                <option value="36">SACOMÃ - 36</option>
                                <option value="37">VILA NOVA - 37</option>
                                <option value="38">SAPOPEMBA - 38</option>
                                <option value="39">POÁ - 39</option>
                                <option value="40">CURITIBA - 40</option>
                                <option value="41">FRANCA - 41</option>
                                <option value="130">JARDIM SÃO PAULO - 130</option>
                                <option value="131">CARAPICUIBA - 131</option>
                                <option value="042">ITAQUERA 2 - 042</option>											
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Link do Produto -->
                <div class="field">
                    <label class="label">Link do Produto:</label>
                    <div class="control">
                        <input class="input" type="url" name="link_produto" placeholder="https://exemplo.com/produto" required>
                    </div>
                </div>

                <!-- Anexo -->
                <div class="field">
                    <label class="label">Anexar Arquivo (PDF/Imagem):</label>
                    <div class="file has-name is-fullwidth">
                        <label class="file-label">
                            <input class="file-input" type="file" name="anexo" accept=".pdf,.jpg,.png,.jpeg">
                            <span class="file-cta">
                                <span class="file-icon">
                                    <i class="fas fa-upload"></i>
                                </span>
                                <span class="file-label">
                                    Selecione o arquivo…
                                </span>
                            </span>
                            <span class="file-name">
                                Nenhum arquivo selecionado
                            </span>
                        </label>
                    </div>
                </div>

                <div class="field mt-6">
                    <div class="control">
                        <button type="submit" class="button is-fullwidth is-medium">
                            <i class="fas fa-paper-plane"></i> Enviar solicitação
                        </button>
                    </div>
                </div>

                <!-- Botão Voltar -->
                <div class="field mt-2">
                    <div class="control">
                        <button type="button" class="button is-fullwidth is-medium" onclick="voltar()">Voltar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="box">
                <h2 class="title is-4 has-text-centered">Solicitação registrada!</h2>
                <div class="content has-text-centered">
                    <p><strong>Código:</strong> <span id="codigoSolicitacao"></span></p>
                    <p><strong>Protocolo:</strong> <span id="protocoloSolicitacao"></span></p>
                    <p class="has-text-grey is-size-7 mt-3">
                        Um e-mail de confirmação foi enviado para o departamento responsável.
                    </p>
                    <button class="button mt-4" onclick="fecharModal()">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Atualizar nome do arquivo
        const fileInput = document.querySelector('.file-input');
        const fileName = document.querySelector('.file-name');
        
        fileInput.onchange = () => {
            if (fileInput.files.length > 0) {
                fileName.textContent = fileInput.files[0].name;
            }
        }

        // Envio do formulário
        document.getElementById('holdingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            fetch('/compras-holding', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if(data.status === 'success') {
                    document.getElementById('codigoSolicitacao').textContent = data.codigo;
                    document.getElementById('protocoloSolicitacao').textContent = data.protocolo;
                    document.getElementById('modal').classList.add('is-active');
                } else {
                    alert('Erro: ' + (data.message || 'Tente novamente mais tarde'));
                }
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao enviar solicitação');
            });
        });

        function fecharModal() {
            document.getElementById('modal').classList.remove('is-active');
            document.getElementById('holdingForm').reset();
            fileName.textContent = 'Nenhum arquivo selecionado';
        }

        // Função para voltar
        function voltar() {
            window.location.href = "/";
        }

        // Fechar modal ao clicar no fundo
        document.querySelector('.modal-background').addEventListener('click', fecharModal);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9290fc994ea220d8',t:'MTc0MzQzNjA2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9291232e19e125b5',t:'MTc0MzQzNzY0Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>